---
title: "Quantification Exercise"
author: "Jack Sudds"
date: "04/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libaries, include=FALSE}
library(tidyverse)
library(readxl)
library(here)
library(skimr) #install.packages("skimr")
library(kableExtra) #install.packages("kableExtra")
library(formattable)#install.packages("formattable")
library(dplyr)
library(janitor)
library(ggplot2)
library(reshape2)#install.packages("reshape2")
```

```{r dataloda}
horse_messy <- read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "B2:D25")

auroch_messy <- read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "E2:G25")

red_deer_messy <- read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "H2:J25")

rabbit_messy <- read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "K2:M25")
```

```{r data-fixing}
nisp_h = sum(horse_messy$Total, na.rm = TRUE)

horse_MNE <- horse_messy %>%
  add_column(read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "A2:A25"), .before = "L") %>%
  rename(element = ...1) %>%
  janitor::clean_names() %>%
  add_row(element = "Total NISP", l = NA, r = NA, total = nisp_h) %>%
  remove_rownames() %>%
  column_to_rownames(var = "element")

nisp_a = sum(auroch_messy$Total, na.rm = TRUE)

auroch_MNE <- auroch_messy %>%
  add_column(read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "A2:A25"), .before = "L") %>%
  rename(element = ...1) %>%
  janitor::clean_names() %>%
  add_row(element = "Total NISP", l = NA, r = NA, total = nisp_a) %>%
  remove_rownames() %>%
  column_to_rownames(var = "element")

nisp_rd = sum(red_deer_MNI_messy$Total, na.rm = TRUE)

red_deer_MNE <- red_deer_messy %>%
  add_column(read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "A2:A25"), .before = "L") %>%
  rename(element = ...1) %>%
  janitor::clean_names() %>%
  add_row(element = "Total NISP", l = NA, r = NA, total = nisp_rd) %>%
  remove_rownames() %>%
  column_to_rownames(var = "element")

nisp_r = sum(rabbit_messy$Total, na.rm = TRUE)

rabbit_MNE <- rabbit_messy %>%
  add_column(read_xlsx(here("data", "data_as_given.xlsx"), sheet = "Data", range = "A2:A25"), .before = "L") %>%
  rename(element = ...1) %>%
  janitor::clean_names() %>%
  add_row(element = "Total_NISP", l = NA, r = NA, total = nisp_r) %>%
  remove_rownames() %>%
  column_to_rownames(var = "element")
```

```{r add MAU column horse}

#element MAU calculations horses

mandibleMAU <- as.numeric(horse_MNE[1, 3])/2
maxillaMAU <- as.numeric(horse_MNE[2, 3])/2
atlasMAU <- as.numeric(horse_MNE[3, 3])/1
axisMAU <- as.numeric(horse_MNE[4, 3])/1
scapulaMAU <- as.numeric(horse_MNE[5, 3])/2
p_humerusMAU <- as.numeric(horse_MNE[6, 3])/2
d_humerusMAU <- as.numeric(horse_MNE[7, 3])/2
p_radiusMAU <- as.numeric(horse_MNE[8, 3])/2
d_radiusMAU <- as.numeric(horse_MNE[9, 3])/2
p_metacarpalMAU <- as.numeric(horse_MNE[10, 3])/2
d_metacarpalMAU <- as.numeric(horse_MNE[11, 3])/2
pelvisMAU <- as.numeric(horse_MNE[12, 3])/2
p_femurMAU <- as.numeric(horse_MNE[13, 3])/2
d_femurMAU <- as.numeric(horse_MNE[14, 3])/2
p_tibiaMAU <- as.numeric(horse_MNE[15, 3])/2
d_tibiaMAU <- as.numeric(horse_MNE[16, 3])/2
astragalusMAU <- as.numeric(horse_MNE[17, 3])/2
calcaneumMAU <- as.numeric(horse_MNE[18, 3])/2
p_metatarsalMAU <- as.numeric(horse_MNE[19, 3])/2
d_metatarsalMAU <- as.numeric(horse_MNE[20, 3])/2
phalange1MAU <- as.numeric(horse_MNE[21, 3])/4
phalange2MAU <- as.numeric(horse_MNE[22, 3])/4
phalange3MAU <- as.numeric(horse_MNE[23, 3])/4

MAU_column <- c(mandibleMAU, maxillaMAU, atlasMAU, axisMAU, scapulaMAU, p_humerusMAU, d_humerusMAU, p_radiusMAU, d_radiusMAU, p_metacarpalMAU, d_metacarpalMAU, pelvisMAU, p_femurMAU, d_femurMAU, p_tibiaMAU, d_tibiaMAU, astragalusMAU, calcaneumMAU, p_metatarsalMAU, d_metatarsalMAU, phalange1MAU, phalange2MAU, phalange3MAU, NA)

horse_MAU <- horse_MNE %>%
  add_column(.after = "total", MAU = MAU_column)

horse_MAU <- horse_MAU %>%
  add_row(.after = "Total NISP", l = NA, r = NA, total = NA, MAU = sum(horse_MAU$MAU, na.rm = TRUE))
  row.names(horse_MAU)[25] <- "Total MAU"
  

```

```{r add MAU column auroch}

#element MAU calculations auroch

mandibleMAU <- as.numeric(auroch_MNE[1, 3])/2
maxillaMAU <- as.numeric(auroch_MNE[2, 3])/2
atlasMAU <- as.numeric(auroch_MNE[3, 3])/1
axisMAU <- as.numeric(auroch_MNE[4, 3])/1
scapulaMAU <- as.numeric(auroch_MNE[5, 3])/2
p_humerusMAU <- as.numeric(auroch_MNE[6, 3])/2
d_humerusMAU <- as.numeric(auroch_MNE[7, 3])/2
p_radiusMAU <- as.numeric(auroch_MNE[8, 3])/2
d_radiusMAU <- as.numeric(auroch_MNE[9, 3])/2
p_metacarpalMAU <- as.numeric(auroch_MNE[10, 3])/2
d_metacarpalMAU <- as.numeric(auroch_MNE[11, 3])/2
pelvisMAU <- as.numeric(auroch_MNE[12, 3])/2
p_femurMAU <- as.numeric(auroch_MNE[13, 3])/2
d_femurMAU <- as.numeric(auroch_MNE[14, 3])/2
p_tibiaMAU <- as.numeric(auroch_MNE[15, 3])/2
d_tibiaMAU <- as.numeric(auroch_MNE[16, 3])/2
astragalusMAU <- as.numeric(auroch_MNE[17, 3])/2
calcaneumMAU <- as.numeric(auroch_MNE[18, 3])/2
p_metatarsalMAU <- as.numeric(auroch_MNE[19, 3])/2
d_metatarsalMAU <- as.numeric(auroch_MNE[20, 3])/2
phalange1MAU <- as.numeric(auroch_MNE[21, 3])/8
phalange2MAU <- as.numeric(auroch_MNE[22, 3])/8
phalange3MAU <- as.numeric(auroch_MNE[23, 3])/8

MAU_column <- c(mandibleMAU, maxillaMAU, atlasMAU, axisMAU, scapulaMAU, p_humerusMAU, d_humerusMAU, p_radiusMAU, d_radiusMAU, p_metacarpalMAU, d_metacarpalMAU, pelvisMAU, p_femurMAU, d_femurMAU, p_tibiaMAU, d_tibiaMAU, astragalusMAU, calcaneumMAU, p_metatarsalMAU, d_metatarsalMAU, phalange1MAU, phalange2MAU, phalange3MAU, NA)

auroch_MAU <- auroch_MNE %>%
  add_column(.after = "total", MAU = MAU_column)

auroch_MAU <- auroch_MAU%>%
  add_row(.after = "Total NISP", l = NA, r = NA, total = NA, MAU = sum(auroch_MAU$MAU, na.rm = TRUE))
  row.names(auroch_MAU)[25] <- "Total MAU"

```

```{r add MAU column red_deer}

#element MAU calculations red_deer

mandibleMAU <- as.numeric(red_deer_MNE[1, 3])/2
maxillaMAU <- as.numeric(red_deer_MNE[2, 3])/2
atlasMAU <- as.numeric(red_deer_MNE[3, 3])/1
axisMAU <- as.numeric(red_deer_MNE[4, 3])/1
scapulaMAU <- as.numeric(red_deer_MNE[5, 3])/2
p_humerusMAU <- as.numeric(red_deer_MNE[6, 3])/2
d_humerusMAU <- as.numeric(red_deer_MNE[7, 3])/2
p_radiusMAU <- as.numeric(red_deer_MNE[8, 3])/2
d_radiusMAU <- as.numeric(red_deer_MNE[9, 3])/2
p_metacarpalMAU <- as.numeric(red_deer_MNE[10, 3])/2
d_metacarpalMAU <- as.numeric(red_deer_MNE[11, 3])/2
pelvisMAU <- as.numeric(red_deer_MNE[12, 3])/2
p_femurMAU <- as.numeric(red_deer_MNE[13, 3])/2
d_femurMAU <- as.numeric(red_deer_MNE[14, 3])/2
p_tibiaMAU <- as.numeric(red_deer_MNE[15, 3])/2
d_tibiaMAU <- as.numeric(red_deer_MNE[16, 3])/2
astragalusMAU <- as.numeric(red_deer_MNE[17, 3])/2
calcaneumMAU <- as.numeric(red_deer_MNE[18, 3])/2
p_metatarsalMAU <- as.numeric(red_deer_MNE[19, 3])/2
d_metatarsalMAU <- as.numeric(red_deer_MNE[20, 3])/2
phalange1MAU <- as.numeric(red_deer_MNE[21, 3])/8
phalange2MAU <- as.numeric(red_deer_MNE[22, 3])/8
phalange3MAU <- as.numeric(red_deer_MNE[23, 3])/8

MAU_column <- c(mandibleMAU, maxillaMAU, atlasMAU, axisMAU, scapulaMAU, p_humerusMAU, d_humerusMAU, p_radiusMAU, d_radiusMAU, p_metacarpalMAU, d_metacarpalMAU, pelvisMAU, p_femurMAU, d_femurMAU, p_tibiaMAU, d_tibiaMAU, astragalusMAU, calcaneumMAU, p_metatarsalMAU, d_metatarsalMAU, phalange1MAU, phalange2MAU, phalange3MAU, NA)

red_deer_MAU <- red_deer_MNE %>%
  add_column(.after = "total", MAU = MAU_column)

red_deer_MAU <- red_deer_MAU%>%
  add_row(.after = "Total NISP", l = NA, r = NA, total = NA, MAU = sum(red_deer_MAU$MAU, na.rm = TRUE))
  row.names(red_deer_MAU)[25] <- "Total MAU"

```

```{r add MAU column rabbit}

#element MAU calculations rabbit

mandibleMAU <- as.numeric(rabbit_MNE[1, 3])/2
maxillaMAU <- as.numeric(rabbit_MNE[2, 3])/2
atlasMAU <- as.numeric(rabbit_MNE[3, 3])/1
axisMAU <- as.numeric(rabbit_MNE[4, 3])/1
scapulaMAU <- as.numeric(rabbit_MNE[5, 3])/2
p_humerusMAU <- as.numeric(rabbit_MNE[6, 3])/2
d_humerusMAU <- as.numeric(rabbit_MNE[7, 3])/2
p_radiusMAU <- as.numeric(rabbit_MNE[8, 3])/2
d_radiusMAU <- as.numeric(rabbit_MNE[9, 3])/2
p_metacarpalMAU <- as.numeric(rabbit_MNE[10, 3])/8
d_metacarpalMAU <- as.numeric(rabbit_MNE[11, 3])/8
pelvisMAU <- as.numeric(rabbit_MNE[12, 3])/2
p_femurMAU <- as.numeric(rabbit_MNE[13, 3])/2
d_femurMAU <- as.numeric(rabbit_MNE[14, 3])/2
p_tibiaMAU <- as.numeric(rabbit_MNE[15, 3])/2
d_tibiaMAU <- as.numeric(rabbit_MNE[16, 3])/2
astragalusMAU <- as.numeric(rabbit_MNE[17, 3])/2
calcaneumMAU <- as.numeric(rabbit_MNE[18, 3])/2
p_metatarsalMAU <- as.numeric(rabbit_MNE[19, 3])/8
d_metatarsalMAU <- as.numeric(rabbit_MNE[20, 3])/8
phalange1MAU <- as.numeric(rabbit_MNE[21, 3])/16
phalange2MAU <- as.numeric(rabbit_MNE[22, 3])/16
phalange3MAU <- as.numeric(rabbit_MNE[23, 3])/16

MAU_column <- c(mandibleMAU, maxillaMAU, atlasMAU, axisMAU, scapulaMAU, p_humerusMAU, d_humerusMAU, p_radiusMAU, d_radiusMAU, p_metacarpalMAU, d_metacarpalMAU, pelvisMAU, p_femurMAU, d_femurMAU, p_tibiaMAU, d_tibiaMAU, astragalusMAU, calcaneumMAU, p_metatarsalMAU, d_metatarsalMAU, phalange1MAU, phalange2MAU, phalange3MAU, NA)

rabbit_MAU <- rabbit_MNE %>%
  add_column(.after = "total", MAU = MAU_column)

rabbit_MAU <- rabbit_MAU%>%
  add_row(.after = "Total NISP", l = NA, r = NA, total = NA, MAU = sum(rabbit_MAU$MAU, na.rm = TRUE))
  row.names(rabbit_MAU)[25] <- "Total MAU"

```